(this.webpackJsonpffbooker=this.webpackJsonpffbooker||[]).push([[0],{84:function(e,t,a){e.exports=a(96)},89:function(e,t,a){},95:function(e,t,a){},96:function(e,t,a){"use strict";a.r(t);var n,r=a(0),l=a.n(r),c=a(13),o=a.n(c),s=(a(89),a(11)),u=a(10),i=a(148),m=a(143),f=a(147),d=a(146),p=a(142),b=a(144),g=a(145),v=a(138),E=a(58),C=a(17),O=a.n(C),h=a(26),y=a(46),k=a.n(y),j=0;function x(e){return S.apply(this,arguments)}function S(){return(S=Object(h.a)(O.a.mark((function e(t){var a,n,r,l,c,o,s,u=arguments;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=function(e){return["Sun","Mon","Tue","Wed","Thu","Fri","Sat"][new Date(1e3*e).getDay()]},c=function(e){return new Date(1e3*e).toLocaleDateString()},l=function(e){return new Date(1e3*e).toTimeString().substring(0,5)},a=u.length>1&&void 0!==u[1]?u[1]:1,n={programIds:t.paramClasses,fromDate:t.fromDate?t.fromDate:parseInt(Date.now()/1e3+t.fromDateAdj),toDate:t.toDate?t.toDate:parseInt(Date.now()/1e3+t.toDateAdj),pageSize:100,pageNumber:a,distance:2147483647,latitude:0,longitude:0},"FFP"!==(null===t||void 0===t?void 0:t.paramClub)&&(n.clubId=t.paramClub),console.log("Search Start"),console.log(n),e.next=10,k.a.ajax({type:"GET",url:"https://api-mobile.circuithq.com/api/v2/class/search",dataType:"json",headers:{Authorization:t.accessToken,"User-Country-Code":"sg"},data:n});case 10:return r=e.sent,s=(s=r.data).map((function(e){var a,n,r,s;return{classId:e.classId,class:e.name,club:null===(a=t.clubTypes)||void 0===a||null===(n=a[e.club.clubId])||void 0===n?void 0:n.fullname,clubTier:null===(r=t.clubTypes)||void 0===r||null===(s=r[e.club.clubId])||void 0===s?void 0:s.type,clubId:e.club.clubId,date:c(e.timeStart),day:o(e.timeStart),timestamp:e.timeStart,duration:e.timeEnd-e.timeStart,start:l(e.timeStart),end:l(e.timeEnd),capacity:e.capacity,address:e.club.address}})).filter((function(e){return e.capacity>0||!t.accessToken||t.paramShowFull})),"FFP"===t.paramClub&&(s=s.filter((function(e){return"Platinum"===e.clubTier}))),"No Work"===t.paramTime&&(s=s.filter((function(e){return"Sat"===e.day||"Sun"===e.day||parseInt(e.end)<=11||parseInt(e.start)>=20}))),e.abrupt("return",s);case 16:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function T(){n()}function I(e){return e.getHours()+":"+e.getMinutes()+":"+e.getSeconds()+"."+e.getMilliseconds()}function w(){return(w=Object(h.a)(O.a.mark((function e(t,a,n,r){var l,c,o,s,u,i,m;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(console.log("Booking... "+t+" ("+I(new Date)+")"),l=(new Date).getTime(),e.prev=2,!n){e.next=13;break}return console.log("DEBUG"),c=Math.random()*Math.random()*Math.random(),o=Math.random()*Math.random()*Math.random(),e.next=9,new Promise((function(e){return setTimeout(e,50+c*o*2e4)}));case 9:if(!(Math.random()>.01)){e.next=11;break}throw{responseText:'{"error":{"messages":["Debug_Error"]}}'};case 11:e.next=18;break;case 13:return e.next=15,k.a.ajax({type:"POST",url:"https://api-mobile.circuithq.com/api/v2/class/book",dataType:"json",headers:{Authorization:a,"User-Country-Code":"sg"},data:{class_id:t}});case 15:s=e.sent,console.table(s),r(null);case 18:return u=(new Date).getTime(),console.log("["+(u-l)+"ms] Success... "+t+" ("+I(new Date)+")"),e.abrupt("return",!0);case 23:return e.prev=23,e.t0=e.catch(2),(i=JSON.parse(e.t0.responseText))&&i.message?console.error(i.message):i&&i.error&&i.error.messages?i.error.messages.forEach((function(e){return console.error(null===e||void 0===e?void 0:e.message)})):console.error(i),m=(new Date).getTime(),console.log("["+(m-l)+"ms] Failed... "+t+" ("+I(new Date)+")"),e.abrupt("return",!1);case 30:case"end":return e.stop()}}),e,null,[[2,23]])})))).apply(this,arguments)}function D(e,t,a,n,r){var l=function(e,t,a,n){return w.apply(this,arguments)}(e,t,a,r).then((function(e){return Promise.resolve((function(t){return new Promise((function(t){return t(e)}))}))})),c=new Promise((function(e){return setTimeout(e,n)})).then((function(e){return function(e){return Promise.resolve(l.then((function(e){return Promise.resolve(e())})))}}));return Promise.race([l,c])}var A=Object(i.a)({tableWrapper:{maxWidth:1e3,margin:"5px 0",backgroundColor:"#ffffffe0"},tableContainer:{maxHeight:"calc(100vh - 20px)",transition:"max-height 0.5s"},table:{minWidth:650,userSelect:"none"},thead:{"& th":{fontWeight:"bold",backgroundColor:"#b6ccdd"}}}),P=function(e){var t=function(e){var t=Object(r.useState)([]),a=Object(u.a)(t,2),l=a[0],c=a[1],o=Object(r.useReducer)((function(e){return e+1}),0),s=Object(u.a)(o,2),i=s[0],m=s[1];return n=m,Object(r.useEffect)((function(){e.paramClasses&&Object.keys(e.clubTypes).length&&Object.keys(e.classTypes).length&&function(){var t=Object(h.a)(O.a.mark((function t(a){var n,r;return O.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return c([]),t.next=3,x(e);case 3:if(n=t.sent,a!==j){t.next=11;break}if(c(n),!(n.length<30)){t.next=11;break}return t.next=9,x(e,2);case 9:r=t.sent,a===j&&c([].concat(Object(E.a)(n),Object(E.a)(r)));case 11:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()(++j)}),[e.fromDateAdj,e.toDateAdj,e.paramClub,e.paramClasses,e.paramTime,e.accessToken,i,e.clubTypes,e.classTypes]),l}(e),a=A(),c=null;return l.a.createElement(v.a,{elevation:3,className:a.tableWrapper},l.a.createElement(p.a,{className:a.tableContainer,style:{maxHeight:t.length?"":36}},l.a.createElement(m.a,{stickyHeader:!0,className:a.table,size:"small"},l.a.createElement(b.a,{className:a.thead},l.a.createElement(g.a,null,l.a.createElement(d.a,null,"ID"),l.a.createElement(d.a,null,"Club"),l.a.createElement(d.a,null,"Class"),l.a.createElement(d.a,null,"Date"),l.a.createElement(d.a,null,"Time"),l.a.createElement(d.a,null,"Capacity"))),l.a.createElement(f.a,null,t.sort((function(e,t){return e.timestamp-t.timestamp})).map((function(t){var a,n=c;return c=t.date,l.a.createElement(g.a,{key:t.classId,onClick:function(){return function(t){e.handleSelection(t)}(t)},style:{backgroundColor:(null===(a=e.selected)||void 0===a?void 0:a.classId)===t.classId?"#00d8f57d":"",boxShadow:null==n||t.date===n?"":"#b6ccdd 0 2px 0 0 inset"},hover:!0},l.a.createElement(d.a,null,t.classId),l.a.createElement(d.a,null,t.club),l.a.createElement(d.a,null,t.class),l.a.createElement(d.a,null,t.date," (",t.day,")"),l.a.createElement(d.a,null,t.start," - ",t.end),l.a.createElement(d.a,null,t.capacity))}))))))},N=a(24),F=a(150),z=a(97),W=a(149),M=a(153),U=a(154),R=a(155),J=a(156),G=a(172),B=Object(r.createContext)(!1),L=null;var H=function(e){var t,a,n,c,o,i,m,f,d,p=Object(r.useState)(parseInt(Date.now()/1e3)),b=Object(u.a)(p,2),g=b[0],E=b[1],C=Object(r.useReducer)((function(t,a){var n={};if("ADD"===a.action||"UPDATE"===a.action)n=Object(s.a)(Object(s.a)({},t),{},Object(N.a)({},a.target.classId,a.target));else if("REMOVE"===a.action){var r=Object(s.a)({},t);delete r[a.target.classId],n=r}else"EXECUTE"===a.action&&(a.target.timestamp=g+e.bookOpen+e.bookOffset+3,n=Object(s.a)(Object(s.a)({},t),{},Object(N.a)({},a.target.classId,a.target)));return localStorage.setItem("watches",JSON.stringify(n)),n}),{},(function(e){var t=localStorage.getItem("watches");return t?JSON.parse(t):{}})),y=Object(u.a)(C,2),k=y[0],j=y[1],S=Object(r.useReducer)((function(e,t){return L=t,t}),null),T=Object(u.a)(S,2),I=T[0],w=T[1],A=q(),P=Object(r.useContext)(B);Object(r.useEffect)((function(){Object(h.a)(O.a.mark((function t(){var a,n,r;return O.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:a=0,n=0;case 2:if(null===I||null===L){t.next=11;break}return t.next=6,D(I,e.accessToken,P,e.bookWait,w);case 6:r=t.sent,console.log(r()),r().then((function(e){e?(j({action:"UPDATE",target:Object(s.a)(Object(s.a)({},k[I]),{},{success:++a,fail:n})}),w(null)):j({action:"UPDATE",target:Object(s.a)(Object(s.a)({},k[I]),{},{success:a,fail:++n})})})),t.next=12;break;case 11:return t.abrupt("break",14);case 12:t.next=2;break;case 14:case"end":return t.stop()}}),t)})))()}),[I]),Object(r.useEffect)((function(){setInterval((function(e){E(parseInt(Date.now()/1e3))}),100)}),[]),Object(r.useEffect)((function(){Object.keys(k).forEach(function(){var t=Object(h.a)(O.a.mark((function t(a){var n,r,l;return O.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if((n=k[a]).lastSeen&&!(g-n.lastSeen>=43200)){t.next=20;break}return n.seenStatus=!1,t.prev=3,t.next=6,x({fromDate:n.timestamp-900,toDate:n.timestamp+n.duration+900,paramClub:n.clubId,paramClasses:"[]",paramTime:"All",paramShowFull:!0,accessToken:e.accessToken});case 6:r=t.sent,l=r.filter((function(e){return e.classId==a}))[0],n.seenStatus=!!l,n.seenCapacity=null===l||void 0===l?void 0:l.capacity,t.next=16;break;case 12:t.prev=12,t.t0=t.catch(3),delete n.seenStatus,console.error(t.t0);case 16:return t.prev=16,n.lastSeen=parseInt(Date.now()/1e3),j({action:"UPDATE",target:n}),t.finish(16);case 20:case"end":return t.stop()}}),t,null,[[3,12,16,20]])})));return function(e){return t.apply(this,arguments)}}())}),[parseInt(g/10)]);var H=function(e){return e.toISOString().replace(/[-:]/g,"").replace(/\d\d\.\d\d\d/,"00")},Q=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],a=parseInt(e/60/60/24);if(t&&a>0)return a+"d";var n=parseInt(e/60/60%24);if(t&&n>0)return n+"h";var r=parseInt(e/60%60);if(t&&r>0)return r+"m";var l=parseInt(e%60);if(t&&l>0)return l+"s";var c=(a?a+"d ":"")+(n?n+"h ":"")+(r?r+"m ":"")+(l?l+"s ":"");return c},Y=l.a.createElement("div",{style:X},l.a.createElement(v.a,{elevation:3,style:{backgroundColor:e.targetClass?k[e.targetClass.classId]?"#fdc4d2":"#c4f6fd":"",padding:5},className:A.preview},l.a.createElement("div",{style:Object(s.a)(Object(s.a)({},Z),{},{margin:"auto"})},e.targetClass&&l.a.createElement(z.a,{onClick:function(t){return a=e.targetClass,void window.open("http://google.com/maps/dir//".concat(escape(a.address)),"_blank");var a}},l.a.createElement(W.a,{color:"action",fontSize:"small"}))),l.a.createElement("strong",null,"Class ID: ")," ",null===(t=e.targetClass)||void 0===t?void 0:t.classId," ",l.a.createElement("br",null),l.a.createElement("strong",null,"Club: ")," ",null===(a=e.targetClass)||void 0===a?void 0:a.club," (",null===(n=e.targetClass)||void 0===n?void 0:n.clubId,") ",l.a.createElement("br",null),l.a.createElement("strong",null,"Class: ")," ",null===(c=e.targetClass)||void 0===c?void 0:c.class," ",l.a.createElement("br",null),l.a.createElement("strong",null,"Date: ")," ",null===(o=e.targetClass)||void 0===o?void 0:o.date," (",null===(i=e.targetClass)||void 0===i?void 0:i.day,") ",l.a.createElement("br",null),l.a.createElement("strong",null,"Time: ")," ",null===(m=e.targetClass)||void 0===m?void 0:m.start," - ",null===(f=e.targetClass)||void 0===f?void 0:f.end," ",l.a.createElement("br",null),l.a.createElement("strong",null,"Capacity: ")," ",null===(d=e.targetClass)||void 0===d?void 0:d.capacity," ",l.a.createElement("br",null),l.a.createElement("div",{style:Z},e.targetClass&&!k[e.targetClass.classId]&&l.a.createElement(F.a,{component:v.a,style:{backgroundColor:"#1c94f3b5"},onClick:function(){return j({action:"ADD",target:e.targetClass})}},"Add"),P&&e.targetClass&&k[e.targetClass.classId]&&l.a.createElement(F.a,{component:v.a,style:{backgroundColor:"#d21cf3"},onClick:function(){return j({action:"EXECUTE",target:e.targetClass})}},"Execute"),e.targetClass&&k[e.targetClass.classId]&&l.a.createElement(F.a,{component:v.a,style:{backgroundColor:"#f31c68b5"},onClick:function(){return j({action:"REMOVE",target:e.targetClass})}},"Remove")))),$=l.a.createElement("div",{style:Object(s.a)(Object(s.a)({},X),{},{overflowX:"hidden",overflowY:"overlay"})},l.a.createElement(v.a,{elevation:3,style:{padding:"1px 5px 1px 5px",backgroundColor:"#ffffffd0"}},l.a.createElement("div",{style:{marginBottom:-6}},l.a.createElement("strong",null,"Execution Queue")),Object.keys(k).map((function(t){var a,n;return l.a.createElement("div",{key:t,style:_},l.a.createElement(v.a,{elevation:2,className:A.hoverPaper,onClick:function(a){return e.handleSelection(k[t])},style:{backgroundColor:(null===(a=e.targetClass)||void 0===a?void 0:a.classId)==t?"#99f3ff":"",padding:3}},l.a.createElement("div",{style:Object(s.a)(Object(s.a)({},V),{},{backgroundColor:I==t?"#d07dff":k[t].success?"#7dff84":k[t].fail?"#ff7daa":"#d0d0d0",boxShadow:(null===(n=e.targetClass)||void 0===n?void 0:n.classId)==t?"#00c4ffbf 0 0 99px 0 inset":"",margin:"-3px -3px 0",padding:"0 3px"})},l.a.createElement("strong",{style:{textDecoration:"underline"}},k[t].club),l.a.createElement("strong",null,": ",k[t].class),l.a.createElement(G.a,{title:function(e){k[t].classId;var a,n=!1===k[t].seenStatus?"[INVALID]":"",r=(null!==(a=k[t].seenCapacity)&&void 0!==a?a:"?")+" / "+k[t].capacity,l=k[t].lastSeen&&"("+Q(parseInt(Date.now()/1e3)-k[t].lastSeen,!0)+" ago)"||"";return"".concat(n," Cap: ").concat(r," ").concat(l)}(),placement:"top",classes:{tooltip:A.tooltip},arrow:!0},l.a.createElement("span",{onClick:function(){delete k[t].lastSeen,delete k[t].seenStatus,j({action:"UPDATE",target:k[t]})}},!0===k[t].seenStatus?l.a.createElement(M.a,{fontSize:"small",style:{color:"green",marginBottom:-3}}):!1===k[t].seenStatus?l.a.createElement(U.a,{fontSize:"small",style:{color:"red",marginBottom:-3}}):l.a.createElement(R.a,{fontSize:"small",style:{color:"gray",marginBottom:-3}}))),l.a.createElement("span",{style:{color:"gray"}})),l.a.createElement("strong",null,k[t].date," (",k[t].day,")"),l.a.createElement("span",null," (",k[t].start," - ",k[t].end,")"),l.a.createElement("br",null),function(t){var a=t.timestamp-g-e.bookOpen-e.bookOffset,n=t.success?l.a.createElement("span",null,"SUCCESS: ",l.a.createElement("strong",{style:{color:"green"}},t.success)," "):"",r=t.fail?l.a.createElement("span",null,"FAILED: ",l.a.createElement("strong",{style:{color:"red"}},t.fail)):"",c=(n||r)&&l.a.createElement("div",null,n,r);if(a<=0&&a+e.bookDuration>=0&&null==I&&!c&&w(t.classId),I===t.classId){if((a+=e.bookDuration)>=0)return l.a.createElement("strong",null,l.a.createElement("span",{style:{color:"red"}},"...EXECUTING...")," (finish in ",parseInt(a)," s)",l.a.createElement("br",null),c);w(null)}else{if(a>=0){var o={color:a>10800?"black":a>3600?"orange":"red"},s=Q(a);return l.a.createElement("span",null,"Start Booking in ",l.a.createElement("strong",{style:o},s))}if(c)return l.a.createElement("span",null,c)}return l.a.createElement("span",null,"Invalid")}(k[t]),l.a.createElement("div",{style:Z},!!k[t].success&&l.a.createElement(z.a,{onClick:function(e){return(a=k[t]).calendarSaved=!0,j({action:"UPDATE",target:a}),void window.open("http://www.google.com/calendar/render?"+"action=TEMPLATE\n&text=".concat(a.class,"\n&dates=").concat(H(new Date(1e3*a.timestamp)),"/").concat(H(new Date(1e3*a.timestamp+1e3*(a.duration||5400))),"\n&details=").concat(a.club+": "+a.class,"\n&location=").concat(escape(a.address),"\n&trp=false\n&sprop=\n&sprop=name:"),"_blank");var a}},l.a.createElement(J.a,{color:k[t].calendarSaved?"disabled":void 0,fontSize:"small"})))))}))));return l.a.createElement(l.a.Fragment,null,Y,!!Object.keys(k).length&&$)},q=Object(i.a)({hoverPaper:{"&:hover":{backgroundColor:"#ffffffff",transform:"scale(1.03)"},transition:"transform 0.1s",backgroundColor:"#ffffff80"},preview:{"&:hover":{backgroundColor:"#fffffff0",transition:"background-color 0.1s"},transition:"",backgroundColor:"#ffffffd0"},tooltip:{top:"8px",color:"#efefef",fontSize:"small",backgroundColor:"#333333","&>span.MuiTooltop-arrow":{backgroundColor:"#333333"}}}),X={margin:"5px 0",flexGrow:1,userSelect:"none"},_={margin:"8px 0px",flexGrow:1},V={borderRadius:"5px 5px 0px 0px "},Z={float:"right",margin:"-40px 5px",gap:5,display:"grid",gridTemplateColumns:"auto auto"},Q=a(171),Y=a(169),$=a(166),K=a(164),ee=a(165),te=a(173),ae=a(157),ne=a(158),re=a(159),le=a(167),ce=a(160);var oe=function(e){var t=Object(r.useState)(e.accessToken),a=Object(u.a)(t,2),n=a[0],c=a[1],o=function(t){c(e.accessToken),e.setOpen(!1)};return l.a.createElement(te.a,{open:e.open,onClose:o},l.a.createElement(ae.a,null,"Settings"),l.a.createElement(ne.a,null,l.a.createElement(re.a,null,"Access Token is required for getting class capacity and booking classes."),l.a.createElement("br",null),l.a.createElement(le.a,{label:"Access Token",placeholder:"Bearer 58f7GciOiJIUzI1NiJ9.eyJpc3MiOiJodHRw3...",multiline:!0,fullWidth:!0,rows:8,variant:"outlined",InputLabelProps:{shrink:!0},value:n,onChange:function(e){return c(e.target.value)}})),l.a.createElement(ce.a,null,l.a.createElement(F.a,{onClick:o,color:"primary"},"Cancel"),l.a.createElement(F.a,{onClick:function(t){e.setAccessToken(n),localStorage.setItem("accessToken",n),e.setOpen(!1)},color:"primary"},"Save")))},se=a(168),ue=a(161),ie=a(162),me=a(163);var fe=function(e){var t=Object(r.useState)(null),a=Object(u.a)(t,2),n=a[0],c=a[1],o=Object(r.useState)(e.favs),i=Object(u.a)(o,2),m=i[0],f=i[1];Object(r.useEffect)((function(){return f(e.favs)}),[e.favs,e.open]);var d=de(),p=function(t){e.setOpen(!1),f({}),c(null)},b={};return Object.keys(e.favChoices||{}).forEach((function(t){return b[e.favChoices[t].type]=!0})),l.a.createElement(te.a,{open:e.open,onClose:p,fullWidth:!0},l.a.createElement(ae.a,null,"Favorite ",e.favTypeText),l.a.createElement(ne.a,null,l.a.createElement(se.a,{TabIndicatorProps:{style:{backgroundColor:"#0000"}},value:n,textColor:"secondary",onChange:function(e,t){return c(t)},className:d.tab},l.a.createElement(ue.a,{value:null,label:"All",wrapped:!0}),Object.keys(b).map((function(e){return l.a.createElement(ue.a,{key:e,value:e,label:e})}))),l.a.createElement(v.a,{className:d.list},Object.keys(e.favChoices||{}).filter((function(t){return null==n||e.favChoices[t].type===n})).sort((function(t,a){return(e.favChoices[t].fullname||e.favChoices[t].name).localeCompare(e.favChoices[a].fullname||e.favChoices[a].name)})).map((function(t){return l.a.createElement(v.a,{className:"".concat(d.item," ").concat(m[t]?d.selectedItem:""),onClick:function(){return f(Object(s.a)(Object(s.a)({},m),{},Object(N.a)({},t,!m[t])))},key:t},m[t]?l.a.createElement(ie.a,{color:"secondary",className:d.star}):l.a.createElement(me.a,{color:"action",className:d.star}),e.favChoices[t].fullname||e.favChoices[t].name)})))),l.a.createElement(ce.a,null,l.a.createElement(F.a,{onClick:p,color:"primary"},"Cancel"),l.a.createElement(F.a,{onClick:function(t){localStorage.setItem(e.favType,JSON.stringify(m)),e.updateFavs(),p()},color:"primary"},"Save")))},de=Object(i.a)({tab:{backgroundColor:"whitesmoke",borderRadius:"10px 10px 0px 0px","& [role=tablist]":{flexFlow:"wrap"},"& [role=tablist]>.Mui-selected":{backgroundColor:"#f7d7e1",borderRadius:"10px 10px 0px 0px",border:"2px #f7d7e6 solid"},"& [role=tablist]>button":{backgroundColor:"#00000008",borderRadius:"10px 10px 0px 0px",borderTop:"2px #f5f5f5 solid"}},list:{height:"50vh",overflow:"auto",backgroundColor:"#f5f5f5",position:"relative"},item:{padding:8,margin:5,paddingLeft:35,userSelect:"none","&:hover":{transform:"scale(1.02)"}},selectedItem:{backgroundColor:"#f66497",fontWeight:"bold"},star:{position:"absolute",left:10}});var pe=function(e){var t=Object(r.useState)({}),a=Object(u.a)(t,2),n=a[0],c=a[1],o=Object(r.useState)({}),i=Object(u.a)(o,2),m=i[0],f=i[1],d=Object(r.useState)({}),p=Object(u.a)(d,2),b=p[0],g=p[1],E=Object(r.useState)(null),C=Object(u.a)(E,2),O=C[0],h=C[1],y=Object(r.useState)(null),k=Object(u.a)(y,2),j=k[0],x=k[1],S=Object(r.useState)(null),I=Object(u.a)(S,2),w=I[0],D=I[1],A=function(){c(JSON.parse(localStorage.getItem("favClubs")||"{}")),f(JSON.parse(localStorage.getItem("favClasses")||"{}"))};Object(r.useEffect)(A,[]);var P=Object(r.useState)(!1),W=Object(u.a)(P,2),M=W[0],U=W[1],R=Object(r.useState)(!1),J=Object(u.a)(R,2),G=J[0],B=J[1],L=Object(s.a)({All:null,Platinum:"FFP"},Object.keys(n).filter((function(e){return n[e]})).reduce((function(t,a){var n;return t[null===(n=e.clubTypes[a])||void 0===n?void 0:n.shortname]=a,t}),{})),H=Object(s.a)({Access:[183,184,185,182]},Object.keys(m).filter((function(e){return m[e]})).reduce((function(t,a){var n;return t[null===(n=e.classTypes[a])||void 0===n?void 0:n.shortname]=[a],t}),{})),q=Object(r.useReducer)((function(e,t){return localStorage.setItem("selClub",t),t}),null,(function(){return localStorage.getItem("selClub")})),X=Object(u.a)(q,2),_=X[0],V=X[1],Z=Object(r.useReducer)((function(e,t){return localStorage.setItem("selClasses",JSON.stringify(t)),t}),{},(function(){return JSON.parse(localStorage.getItem("selClasses")||"{}")})),te=Object(u.a)(Z,2),ae=te[0],ne=te[1],re=Object(r.useReducer)((function(e,t){return localStorage.setItem("selTime",t),t}),"All",(function(){return localStorage.getItem("selTime")||"All"})),le=Object(u.a)(re,2),ce=le[0],se=le[1];Object(r.useEffect)((function(){e.setParamClub(_),e.setParamClasses("["+Object.keys(ae).filter((function(e){return ae[e]})).map((function(e){return H[e]})).flat()+"]"),e.setParamTime(ce)}));var ue=ge();return l.a.createElement("div",{style:be},l.a.createElement(v.a,{elevation:3,style:{padding:5},className:ue.filter},l.a.createElement("span",{style:{float:"right"}},l.a.createElement(z.a,{onClick:function(e){return B(!0)}},l.a.createElement(K.a,{color:"action",fontSize:"small"})),l.a.createElement(oe,{open:G,setOpen:B,accessToken:e.accessToken,setAccessToken:e.setAccessToken}),l.a.createElement(fe,Object.assign({open:M,setOpen:U},{favs:b,favType:O,favTypeText:j,favChoices:w,updateFavs:A}))),l.a.createElement("strong",null,"Club: "),l.a.createElement(z.a,{style:{position:"absolute",margin:-10},onClick:function(t){h("favClubs"),x("Clubs"),D(e.clubTypes),g(n),U(!0)}},l.a.createElement(ee.a,{color:"action",fontSize:"small"})),l.a.createElement("br",null),Object.keys(L).map((function(e){return l.a.createElement("span",{key:e},l.a.createElement($.a,{control:l.a.createElement(Y.a,{checked:_==L[e],onChange:function(t){return V(L[e])}}),label:e}))})),l.a.createElement("br",null),l.a.createElement("strong",null,"Class: "),l.a.createElement(z.a,{style:{position:"absolute",margin:-10},onClick:function(t){h("favClasses"),x("Classes"),D(e.classTypes),g(m),U(!0)}},l.a.createElement(ee.a,{color:"action",fontSize:"small"})),l.a.createElement("br",null),Object.keys(H).map((function(e){return l.a.createElement("span",{key:e},l.a.createElement($.a,{control:l.a.createElement(Q.a,{checked:ae[e]||!1,onChange:function(t){return ne(Object(s.a)(Object(s.a)({},ae),{},Object(N.a)({},e,!ae[e])))}}),label:e}))})),l.a.createElement("br",null),l.a.createElement("strong",null,"Time: "),l.a.createElement("br",null),["All","No Work"].map((function(e){return l.a.createElement("span",{key:e},l.a.createElement($.a,{control:l.a.createElement(Y.a,{checked:ce==e,onChange:function(t){return se(e)}}),label:e}))})),l.a.createElement("br",null),l.a.createElement("div",{style:ve},l.a.createElement(F.a,{component:v.a,style:{backgroundColor:"#ff4571"},onClick:T},"Search"))))},be={margin:"5px 0",flexGrow:1,userSelect:"none"},ge=Object(i.a)({filter:{"&:hover":{backgroundColor:"#fffffff0"},transition:"background-color 0.1s",backgroundColor:"#ffffffd0"}}),ve={float:"right",margin:"-40px 5px",gap:5,display:"grid",gridTemplateColumns:"auto auto"};a(95);var Ee=function(){var e=Object(r.useState)((function(e){return localStorage.getItem("accessToken")||""})),t=Object(u.a)(e,2),a=t[0],n=t[1],c=Object(r.useReducer)((function(e,t){return(null===e||void 0===e?void 0:e.classId)!==(null===t||void 0===t?void 0:t.classId)?t:null}),null),o=Object(u.a)(c,2),i=o[0],m=o[1],f=function(e){var t=Object(r.useState)({}),a=Object(u.a)(t,2),n=a[0],l=a[1];return Object(r.useEffect)((function(){function t(){return(t=Object(h.a)(O.a.mark((function t(){var a;return O.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,k.a.ajax({type:"GET",url:"https://api-mobile.circuithq.com/api/v2/club/sg",dataType:"json",headers:{Authorization:e.accessToken,"User-Country-Code":"sg"}});case 2:a=t.sent,l(a.data.reduce((function(e,t){return e[t.clubId]={name:t.name,address:t.address,fullname:t.clubWebsiteName,shortname:t.name.replace(/^FFP?\s*/,""),type:t.name.indexOf("FFP")>=0?"Platinum":"Premium"},e}),{}));case 4:case"end":return t.stop()}}),t)})))).apply(this,arguments)}!function(){t.apply(this,arguments)}()}),[e.accessToken]),n}({accessToken:a}),d=function(e){var t=Object(r.useState)({}),a=Object(u.a)(t,2),n=a[0],l=a[1];return Object(r.useEffect)((function(){function t(){return(t=Object(h.a)(O.a.mark((function t(){var a,n;return O.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,k.a.ajax({type:"GET",url:"https://api-mobile.circuithq.com/api/v2/topic/sg",dataType:"json",headers:{Authorization:e.accessToken,"User-Country-Code":"sg"}});case 2:a=t.sent,n={},l(a.data.flatMap((function(e){return n[e.programTypeId]=e.name,e.subTopics})).reduce((function(e,t){return e[t.programId]={name:t.name,shortname:t.name.replace(/([A-Za-z0-9])([A-Za-z0-9]*)/g,(function(e,t,a){return t.toUpperCase()+a.toLowerCase()})),type:n[t.programTypeId]},e}),{}));case 5:case"end":return t.stop()}}),t)})))).apply(this,arguments)}!function(){t.apply(this,arguments)}()}),[e.accessToken]),n}({accessToken:a}),p=Object(r.useState)(null),b=Object(u.a)(p,2),g=b[0],v=b[1],E=Object(r.useState)(null),C=Object(u.a)(E,2),y=C[0],j=C[1],x=Object(r.useState)(null),S=Object(u.a)(x,2),T=S[0],I=S[1];function w(e){e.target===e.currentTarget&&m(null)}return l.a.createElement(B.Provider,{value:!1},l.a.createElement("div",{style:Object(s.a)(Object(s.a)({},Ce),{},{display:"flex"}),onClick:w},l.a.createElement("div",{style:Object(s.a)(Object(s.a)({},Oe),{},{maxWidth:1e3}),onClick:w},l.a.createElement(P,Object.assign({handleSelection:function(e){return m(e)},fromDateAdj:0,toDateAdj:511200,selected:i,accessToken:a},{paramClub:g,paramClasses:y,paramTime:T},{clubTypes:f,classTypes:d}))),l.a.createElement("div",{style:Object(s.a)(Object(s.a)({},Oe),{},{minWidth:"325px",maxWidth:"400px",flexGrow:0}),onClick:w},l.a.createElement("div",{style:{display:"flex",flexDirection:"column",maxHeight:"100%"}},l.a.createElement(pe,Object.assign({setParamClub:v,setParamClasses:j,setParamTime:I},{accessToken:a,setAccessToken:n},{clubTypes:f,classTypes:d})),l.a.createElement(H,Object.assign({handleSelection:function(e){return m(e)},targetClass:i,bookOpen:165600,bookOffset:1,bookDuration:10,bookWait:150,accessToken:a},{clubTypes:f,classTypes:d}))))))},Ce={position:"absolute",top:0,bottom:0,left:0,right:0,zIndex:-1,padding:"0 5px"},Oe={margin:"5px 5px",flexGrow:1};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(l.a.createElement(l.a.StrictMode,null,l.a.createElement(Ee,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[84,1,2]]]);
//# sourceMappingURL=main.c4b3d4e8.chunk.js.map